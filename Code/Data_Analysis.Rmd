---
title: "Data Analysis"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library}
library(tidyverse)
library(lubridate)
#install.packages("trend") - runs stationary tests
library(trend)
#install.packages("zoo") - replaces missing values in time series
library(zoo)
#install.packages("Kendall") - specific to one stationary test to be performed
library(Kendall)
#install.packages("tseries")
library(tseries)
library(RColorBrewer)
library(viridis)
library(pals)


#set theme
mytheme <- theme_classic(base_size = 14) +
  theme(axis.text = element_text(color = "black"), 
        legend.position = "top")
theme_set(mytheme)
```

```{r}
#simple visualization 
CH4_plot <- ggplot(Poop_CH4, aes(x=Year, y=Value, color=Item))+
  geom_line(aes(size=2))
print(CH4_plot)
```

```{r decompose.time.series}

#filter to remove projected data (remove empty years) 
CH4_time <- Poop_CH4 %>% 
  filter(Year %in% c(1980:2018))

#create time series component
CH4_ts <- ts(CH4_time$Value, start=1980, end=2018)

CH4_nonseasonal <- mk.test(CH4_ts)
CH4_nonseasonal

#decompose time series
#CH4_decomposed <- stl(CH4_ts, t.window = "periodic")
```
```{r}
CH4_asses <- CH4_time %>% 
  filter(Item=="Asses")

CH4_asses_ts <- ts(CH4_asses$Value, start=1980, end=2018, frequency=1)
CH4_asses_decomposed <- stl(CH4_asses_ts, s.window = "periodic")

#use a cowplot
#use plot.ts or ts.plot
#pivot wider to separate items
#trend for time series

```


